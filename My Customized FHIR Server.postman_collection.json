{
	"info": {
		"_postman_id": "6155f857-d27e-4d0f-8673-b34d784b3dd5",
		"name": "My Customized FHIR Server",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "3919834"
	},
	"item": [
		{
			"name": "Metadata",
			"item": [
				{
					"name": "metadata",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseurl}}/metadata",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"metadata"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Create resources",
			"item": [
				{
					"name": "Create Organization 1",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.test(\"id is present\", function () {\r",
									"            if (pm.expect(jsonData.id).exist)\r",
									"            {\r",
									"                pm.collectionVariables.set(\"organization1_id\", jsonData.id);\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"ETag header is present\", function () {\r",
									"            if (pm.response.to.have.header(\"ETag\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"organization1_etag\", pm.response.headers.get(\"ETag\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"        if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"        {\r",
									"            pm.collectionVariables.set(\"organization1_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"            console.log(pm.collectionVariables.get(\"organization1_id\"));\r",
									"        }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Organization\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Organization\"\r\n        ]\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"http://fhir.nl/fhir/NamingSystem/agb-zz\",\r\n            \"value\": \"1234.4567\"\r\n        }\r\n    ],\r\n    \"active\": true,\r\n    \"type\": [\r\n        {\r\n            \"coding\": [\r\n                {\r\n                    \"system\": \"http://nictiz.nl/fhir/NamingSystem/organization-typez\",\r\n                    \"code\": \"G5\",\r\n                    \"display\": \"Geestelijke Gezondheidszorg\"\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"name\": \"organization 1\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Organization",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Organization"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Organization 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.test(\"id is present\", function () {\r",
									"            if (pm.expect(jsonData.id).exist)\r",
									"            {\r",
									"                pm.collectionVariables.set(\"organization2_id\", jsonData.id);\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"ETag header is present\", function () {\r",
									"            if (pm.response.to.have.header(\"ETag\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"organization2_etag\", pm.response.headers.get(\"ETag\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"        if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"        {\r",
									"            pm.collectionVariables.set(\"organization2_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"            console.log(pm.collectionVariables.get(\"organization2_id\"));\r",
									"        }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Organization\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Organization\"\r\n        ]\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"http://fhir.nl/fhir/NamingSystem/agb-zz\",\r\n            \"value\": \"1234.4568\"\r\n        }\r\n    ],\r\n    \"active\": true,\r\n    \"type\": [\r\n        {\r\n            \"coding\": [\r\n                {\r\n                    \"system\": \"http://nictiz.nl/fhir/NamingSystem/organization-typez\",\r\n                    \"code\": \"G5\",\r\n                    \"display\": \"Geestelijke Gezondheidszorg\"\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"name\": \"organization 2\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Organization",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Organization"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Patient 1",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.test(\"id is present\", function () {\r",
									"            if (pm.expect(jsonData.id).exist)\r",
									"            {\r",
									"                pm.collectionVariables.set(\"patient1_id\", jsonData.id);\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"ETag header is present\", function () {\r",
									"            if (pm.response.to.have.header(\"ETag\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"patient1_etag\", pm.response.headers.get(\"ETag\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"        if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"        {\r",
									"            pm.collectionVariables.set(\"patient1_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"            console.log(pm.collectionVariables.get(\"patient1_id\"));\r",
									"        }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Patient\",\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"http://someidentfier\",\r\n            \"value\": \"1239\"\r\n        }\r\n    ],\r\n    \"active\": true,\r\n    \"name\": [\r\n        {\r\n            \"family\": \"Doe\",\r\n            \"given\": [ \"Jane\" ]\r\n        }\r\n    ],\r\n    \"telecom\": [\r\n        {\r\n            \"system\": \"email\",\r\n            \"value\": \"janedoe@gmail.com\",\r\n            \"use\": \"home\"\r\n        }\r\n    ],\r\n    \"gender\": \"female\",\r\n    \"birthDate\": \"1974-08-16\",\r\n    \"managingOrganization\": {\r\n        \"reference\": \"Organization/{{organization1_id}}\"\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Patient",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Patient"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Patient 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.test(\"id is present\", function () {\r",
									"            if (pm.expect(jsonData.id).exist)\r",
									"            {\r",
									"                pm.collectionVariables.set(\"patient2_id\", jsonData.id);\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"ETag header is present\", function () {\r",
									"            if (pm.response.to.have.header(\"ETag\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"patient2_etag\", pm.response.headers.get(\"ETag\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"        if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"        {\r",
									"            pm.collectionVariables.set(\"patient2_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"            console.log(pm.collectionVariables.get(\"patient2_id\"));\r",
									"        }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {
							"content-type": true
						}
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "default"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Patient\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Patient\"\r\n        ]\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"use\": \"official\",\r\n            \"system\": \"http://irma.app\",\r\n            \"value\": \"mvdstoep@vzvz.nl\"\r\n        }\r\n    ],\r\n    \"active\": true,\r\n    \"name\": [\r\n        {\r\n            \"family\": \"Stoep, van der\",\r\n            \"given\": [ \"Marie\" ]\r\n        }\r\n    ],\r\n    \"telecom\": [\r\n        {\r\n            \"system\": \"email\",\r\n            \"value\": \"mvdstoep@vzvz.nl\",\r\n            \"use\": \"home\"\r\n        }\r\n    ],\r\n    \"gender\": \"female\",\r\n    \"birthDate\": \"1974-08-16\",\r\n    \"managingOrganization\": {\r\n        \"reference\": \"Organization/{{organization2_id}}\"\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Patient",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Patient"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Practitioner",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.test(\"id is present\", function () {\r",
									"            if (pm.expect(jsonData.id).exist)\r",
									"            {\r",
									"                pm.collectionVariables.set(\"practitioner1_id\", jsonData.id);\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"ETag header is present\", function () {\r",
									"            if (pm.response.to.have.header(\"ETag\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"practitioner1_etag\", pm.response.headers.get(\"ETag\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"        if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"        {\r",
									"            pm.collectionVariables.set(\"practitioner1_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"            console.log(pm.collectionVariables.get(\"practitioner1_id\"));\r",
									"        }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {}
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/fhir+json",
								"type": "default"
							},
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "default"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\t\"resourceType\": \"Practitioner\",\r\n    \"meta\":    {\r\n       \"profile\": [ \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Practitioner\" ]\r\n    },\r\n\t\"identifier\": [\r\n\t\t{\r\n\t\t\t\"use\": \"official\",\r\n\t\t\t\"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n\t\t\t\"value\": \"1740715473\"\r\n\t\t}\r\n\t],\r\n\t\"active\": true,\r\n    \"name\": [\r\n        {\r\n            \"family\": \"Botje\",\r\n            \"given\": [\r\n                \"Berta\"\r\n            ]\r\n        }\r\n    ],\r\n\t\"telecom\": [\r\n\t\t{\r\n\t\t\t\"system\": \"phone\",\r\n\t\t\t\"value\": \"0699999999\",\r\n\t\t\t\"use\": \"work\"\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"system\": \"email\",\r\n\t\t\t\"value\": \"vthuis@vzvz.nl\",\r\n\t\t\t\"use\": \"home\"\r\n\t\t}\r\n\t],\r\n\t\"gender\": \"male\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Practitioner",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Practitioner"
							]
						}
					},
					"response": []
				},
				{
					"name": "ActivityDefinition 1 create (succeeds)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.collectionVariables.set(\"activitydefinition_id\", jsonData.id);\r",
									"        pm.collectionVariables.set(\"activitydefinition_etag\", pm.response.headers.get(\"ETag\"));\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"            if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"activitydefinition_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"                console.log(pm.collectionVariables.get(\"activitydefinition_id\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {
							"content-type": true
						}
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "default"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "default"
							},
							{
								"key": "X-Trace-Id",
								"value": "ef0d8ddc-9444-41f5-b493-00d07cd7c51f",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"ActivityDefinition\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2ActivityDefinition\"\r\n        ]\r\n    },\r\n    \"extension\": [\r\n        {\r\n            \"url\": \"http://koppeltaal.nl/fhir/StructureDefinition/KT2PublisherIdentifier\",\r\n            \"valueId\": \"ID1234-001\"\r\n        }\r\n    ],\r\n    \"url\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2\",\r\n    \"identifier\": [\r\n        {\r\n            \"use\": \"official\",\r\n            \"system\": \"http://ns.minddistrict.com/content/id\",\r\n            \"value\": \"6bea89a73b3d48d0963d627d93d071c2\"\r\n        }\r\n    ],\r\n    \"version\": \"1.0\",\r\n    \"name\": \"Piekermoment-md-6bea89a73b3d48d0963d627d93d071c2\",\r\n    \"title\": \"Piekermoment (md)\",\r\n    \"status\": \"active\",\r\n    \"description\": \"In dit dagboek wordt per piekermoment geregistreerd over welk onderwerp werd gepiekerd, welke piekergedachten er voorkwamen en wat hielp om te stoppen met piekeren. \"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/ActivityDefinition",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"ActivityDefinition"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Task",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.test(\"id is present\", function () {\r",
									"            if (pm.expect(jsonData.id).exist)\r",
									"            {\r",
									"                pm.collectionVariables.set(\"task1_id\", jsonData.id);\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"ETag header is present\", function () {\r",
									"            if (pm.response.to.have.header(\"ETag\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"task1_etag\", pm.response.headers.get(\"ETag\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"        if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"        {\r",
									"            pm.collectionVariables.set(\"task1_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"            console.log(pm.collectionVariables.get(\"task1_id\"));\r",
									"        }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ]\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2|1.0\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/{{patient1_id}}\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n            \"value\": \"1740715473\"\r\n        },\r\n        \"type\": \"Practitioner\"\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient/{{patient1_id}}\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Post-processing",
			"item": [
				{
					"name": "Read Patient 1",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/fhir+json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/Patient/{{patient1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Patient",
								"{{patient1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Read Organization",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/fhir+json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/Organization/{{organization1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Organization",
								"{{organization1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Search Task",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/fhir+json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/Task?_elements=id,identifier,for",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task"
							],
							"query": [
								{
									"key": "_elements",
									"value": "id,identifier,for"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Referential Integrity - insert and update",
			"item": [
				{
					"name": "Update Task (fails on patient reference)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"id\": \"{{task1_id}}\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ],\r\n        \"lastUpdated\": \"2023-04-11T15:17:43Z\",\r\n        \"versionId\": \"1\"\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2|1.0\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/1\",\r\n        \"type\": \"Patient\",\r\n        \"display\": \"(not-found)\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n            \"value\": \"1740715473\"\r\n        },\r\n        \"type\": \"Practitioner\"\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient?identifier=https://TaskSystem|12345\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task/{{task1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task",
								"{{task1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Task (fails on Patient)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"id\": \"{{task1_id}}\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ],\r\n        \"lastUpdated\": \"2023-04-11T15:17:43Z\",\r\n        \"versionId\": \"1\"\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2|1.0\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/7d823b2d-d605-46e5-baa7-a19db9a41168\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n            \"value\": \"1740715473\"\r\n        },\r\n        \"type\": \"Practitioner\"\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient?identifier=https://TaskSystem|12345\",\r\n        \"type\": \"Patient\",\r\n        \"display\": \"(not-found)\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task/{{task1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task",
								"{{task1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Task (fails on missing logical reference.type)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"id\": \"{{task1_id}}\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ],\r\n        \"lastUpdated\": \"2023-04-11T15:17:43Z\",\r\n        \"versionId\": \"1\"\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2|1.0\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/{{patient1_id}}\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n            \"value\": \"1740715473\"\r\n        }\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient?identifier=https://TaskSystem|1233\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task/{{task1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task",
								"{{task1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Task (fails on Practitioner)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"id\": \"{{task1_id}}\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ],\r\n        \"lastUpdated\": \"2023-04-11T15:17:43Z\",\r\n        \"versionId\": \"1\"\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2|1.0\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/{{patient1_id}}\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n            \"value\": \"1740715473x\"\r\n        },\r\n        \"type\": \"Practitioner\"\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient?identifier=http://someidentfier|1233\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task/{{task1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task",
								"{{task1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Task (fails on owner)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"id\": \"{{task1_id}}\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ],\r\n        \"lastUpdated\": \"2023-04-11T15:17:43Z\",\r\n        \"versionId\": \"1\"\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2|1.0\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/{{patient1_id}}\",\r\n        \"type\": \"Patient\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n            \"value\": \"1740715473\"\r\n        },\r\n        \"type\": \"Practitioner\"\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient?identifier=https://TaskSystem|12345\",\r\n        \"type\": \"Patient\",\r\n        \"display\": \"(not-found)\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task/{{task1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task",
								"{{task1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Task (succeeds!)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"id\": \"{{task1_id}}\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ],\r\n        \"lastUpdated\": \"2023-04-11T15:17:43Z\",\r\n        \"versionId\": \"1\"\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://intkt2-sprint-7.minddistrict.dev/catalogue/6bea89a73b3d48d0963d627d93d071c2|1.0\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/{{patient1_id}}\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n            \"value\": \"1740715473\"\r\n        },\r\n        \"type\": \"Practitioner\"\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient?identifier=http://someidentfier|1239\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task/{{task1_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task",
								"{{task1_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "ActivityDefinition 2 create (succeeds)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.collectionVariables.set(\"activitydefinition2_id\", jsonData.id);\r",
									"        pm.collectionVariables.set(\"activitydefinition2_etag\", pm.response.headers.get(\"ETag\"));\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"            if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"activitydefinition2_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"                console.log(pm.collectionVariables.get(\"activitydefinition2_id\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {
							"content-type": true
						}
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "default"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "default"
							},
							{
								"key": "X-Trace-Id",
								"value": "ef0d8ddc-9444-41f5-b493-00d07cd7c51f",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"ActivityDefinition\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2ActivityDefinition\"\r\n        ]\r\n    },\r\n    \"extension\": [\r\n        {\r\n            \"url\": \"http://koppeltaal.nl/fhir/StructureDefinition/KT2PublisherIdentifier\",\r\n            \"valueId\": \"ID1234-001\"\r\n        }\r\n    ],\r\n    \"url\": \"https://mygames.com/veryserious\",\r\n    \"identifier\": [\r\n        {\r\n            \"use\": \"official\",\r\n            \"system\": \"http://mygames.com/identifiers\",\r\n            \"value\": \"008\"\r\n        }\r\n    ],\r\n    \"version\": \"1.0\",\r\n    \"name\": \"Serious game\",\r\n    \"title\": \"Lets get serious\",\r\n    \"status\": \"active\",\r\n    \"description\": \"In this game....\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/ActivityDefinition",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"ActivityDefinition"
							]
						}
					},
					"response": []
				},
				{
					"name": "ActivityDefinition search",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([200]))\r",
									"  {\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {
							"content-type": true
						}
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "default"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "default"
							},
							{
								"key": "X-Trace-Id",
								"value": "ef0d8ddc-9444-41f5-b493-00d07cd7c51f",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/ActivityDefinition",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"ActivityDefinition"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Referential Integrity - delete",
			"item": [
				{
					"name": "Post Task 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([201,422]))\r",
									"  {\r",
									"    var jsonData = JSON.parse(responseBody);\r",
									"\r",
									"    if (pm.response.code == 201)\r",
									"    {\r",
									"        pm.test(\"id is present\", function () {\r",
									"            if (pm.expect(jsonData.id).exist)\r",
									"            {\r",
									"                pm.collectionVariables.set(\"task2_id\", jsonData.id);\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"ETag header is present\", function () {\r",
									"            if (pm.response.to.have.header(\"ETag\"))\r",
									"            {\r",
									"                pm.collectionVariables.set(\"task2_etag\", pm.response.headers.get(\"ETag\"));\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (pm.response.code == 422)\r",
									"    {\r",
									"        pm.test(\"duplicate\", function () {\r",
									"        if (pm.expect(jsonData.issue[0].code).exist.and.equals(\"duplicate\"))\r",
									"        {\r",
									"            pm.collectionVariables.set(\"task2_id\", jsonData.issue[0].details.text.split(\"'\")[5]);\r",
									"            console.log(pm.collectionVariables.get(\"task2_id\"));\r",
									"        }\r",
									"        });\r",
									"    }\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resourceType\": \"Task\",\r\n    \"meta\": {\r\n        \"profile\": [\r\n            \"http://koppeltaal.nl/fhir/StructureDefinition/KT2Task\"\r\n        ],\r\n        \"lastUpdated\": \"2023-04-11T15:17:43Z\",\r\n        \"versionId\": \"1\"\r\n    },\r\n    \"identifier\": [\r\n        {\r\n            \"system\": \"https://TaskSystem\",\r\n            \"value\": \"12345-4\"\r\n        }\r\n    ],\r\n    \"instantiatesCanonical\": \"https://mygames.com/veryserious\",\r\n    \"description\": \"Releaving stress using mindfulness\",\r\n    \"for\": {\r\n        \"reference\": \"Patient/{{patient2_id}}\"\r\n    },\r\n    \"intent\": \"order\",\r\n    \"priority\": \"routine\",\r\n    \"code\": {\r\n        \"coding\": [\r\n            {\r\n                \"system\": \"http://hl7.org/fhir/CodeSystem/task-code\",\r\n                \"code\": \"fulfill\"\r\n            }\r\n        ]\r\n    },\r\n    \"executionPeriod\": {\r\n        \"start\": \"2021-01-11T08:25:05+10:00\",\r\n        \"end\": \"2021-01-12T08:25:05+10:00\"\r\n    },\r\n    \"requester\": {\r\n        \"identifier\": {\r\n            \"system\": \"http://hl7.org/fhir/sid/us-npi\",\r\n\t\t\t\"value\": \"1740715473\"\r\n        },\r\n        \"type\": \"Practitioner\"\r\n    },\r\n    \"owner\": {\r\n        \"reference\": \"Patient?identifier=http://someidentfier|1239\"\r\n    },\r\n    \"status\": \"requested\",\r\n    \"authoredOn\": \"2020-12-31T08:25:05+10:00\",\r\n    \"lastModified\": \"2020-12-31T09:45:05+10:00\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseurl}}/Task",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Patient 2 (should fail on refint)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/Patient/{{patient2_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Patient",
								"{{patient2_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete ActivityDefinition 2 (fails on refint)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/ActivityDefinition/{{activitydefinition2_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"ActivityDefinition",
								"{{activitydefinition2_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Tasks linked to Patient 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 422\", () => {\r",
									"  if (pm.expect(pm.response.code).to.be.oneOf([200,422]))\r",
									"  {\r",
									"  }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/Task?patient=Patient/{{patient2_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Task"
							],
							"query": [
								{
									"key": "patient",
									"value": "Patient/{{patient2_id}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Patient 2 (no longer fails on refint)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/Patient/{{patient2_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"Patient",
								"{{patient2_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete ActivityDefinition 2 (should now work)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Prefer",
								"value": "return=representation",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseurl}}/ActivityDefinition/{{activitydefinition2_id}}",
							"host": [
								"{{baseurl}}"
							],
							"path": [
								"ActivityDefinition",
								"{{activitydefinition2_id}}"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseurl",
			"value": "http://localhost:2002/fhir/r4",
			"type": "string"
		},
		{
			"key": "endpoint1_id",
			"value": ""
		},
		{
			"key": "endpoint1_etag",
			"value": ""
		},
		{
			"key": "endpoint2_id",
			"value": ""
		},
		{
			"key": "endpoint2_etag",
			"value": ""
		},
		{
			"key": "organization1_id",
			"value": ""
		},
		{
			"key": "organization1_etag",
			"value": ""
		},
		{
			"key": "organization2_id",
			"value": ""
		},
		{
			"key": "organization2_etag",
			"value": ""
		},
		{
			"key": "activitydefinition_id",
			"value": ""
		},
		{
			"key": "activitydefinition_etag",
			"value": ""
		},
		{
			"key": "practitioner1_id",
			"value": ""
		},
		{
			"key": "practitioner1_etag",
			"value": ""
		},
		{
			"key": "patient1_id",
			"value": ""
		},
		{
			"key": "task1_id",
			"value": ""
		},
		{
			"key": "patient2_id",
			"value": ""
		},
		{
			"key": "task1_etag",
			"value": ""
		},
		{
			"key": "patient2_etag",
			"value": ""
		},
		{
			"key": "activitydefinition2_id",
			"value": ""
		},
		{
			"key": "activitydefinition2_etag",
			"value": ""
		},
		{
			"key": "patient1_etag",
			"value": ""
		},
		{
			"key": "task2_id",
			"value": ""
		},
		{
			"key": "task2_etag",
			"value": ""
		}
	]
}